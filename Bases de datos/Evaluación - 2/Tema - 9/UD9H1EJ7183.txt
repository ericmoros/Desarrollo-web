-- 71)	De momento no se ha decidido si se va a aplicar descuento a algún cliente. Calcula cuánto se puede recaudar en total con todos los pedidos antes de aplicar descuentos a los clientes.
SELECT SUM(precio_total)
FROM pedidos;

-- 72)	Muestra el precio más alto de cada categoría y el identificador de la categoría a la que pertenece ese precio.
SELECT id_categoria, MAX(precio_venta)
FROM productos
GROUP BY id_categoria;

-- 73)	Calcula el precio medio de venta de los productos de cada categoría, junto con el identificador de la categoría.
SELECT id_categoria, AVG(precio_venta)
FROM productos
GROUP BY id_categoria;

-- 74)	Muestra el precio más alto de cada categoría junto con el identificador y la descripción de la categoría a la que pertenece ese precio, ordenado por identificador de la categoría.
SELECT productos.id_categoria, MAX(productos.precio_venta), categorias.descripcion
FROM productos, categorias
WHERE categorias.id_categoria = productos.id_categoria
GROUP BY productos.id_categoria, categorias.descripcion;

-- 75)	Muestra el número de productos que hay en cada categoría.
SELECT id_categoria, COUNT(*)
FROM productos
GROUP BY id_categoria;

-- 76)	Ahora muestra la descripción e identificador de la categoría que tiene más productos junto con el número de productos que tiene.
SELECT productos.id_categoria, COUNT(*), categorias.descripcion
FROM productos, categorias
WHERE productos.id_categoria = categorias.id_categoria
GROUP BY productos.id_categoria, categorias.descripcion
HAVING COUNT(*) = (SELECT MAX(COUNT(*)) FROM productos GROUP BY id_categoria);

-- 77)	Selecciona cuánto dinero se gastará en total en cada categoría el cliente con identificador 1001 si no se le hace ningún descuento.
SELECT productos.id_categoria, SUM(detalles_pedidos.precio * detalles_pedidos.cantidad) "Gastos"
FROM detalles_pedidos, productos
WHERE 
  detalles_pedidos.numero_producto = productos.numero_producto AND
  detalles_pedidos.numero_pedido IN
    (SELECT numero_pedido
    FROM pedidos
    WHERE id_cliente = 1001)
GROUP BY productos.id_categoria;

-- 78)	Muestra la descripción de las categorías que tengan más de 5 productos en venta.En los ejercicios que siguen se supone que no se va a hacer descuento a los clientes.
-- 79)	Muestra nombre, apellidos e identificador de los clientes que tendrán que pagar más de 14000 € en productos de la categoría 1.
-- 80)	Muestra, para cada empleado, cuánto dinero ha hecho en pedidos.
-- 81)	Muestra cuánto recaudarán en pedidos los empleados 701,702 y 703.
-- 82)	Ahora muestra los 3 empleados que más dinero van a recaudar en pedidos. Debe aparecer el identificador del empleado, el nombre y el dinero recaudado
-- 83)	Busca el proveedor o proveedores que menos días de envío tengan para algún producto. Debes mostrar el nombre del proveedor junto con el nombre del producto que tiene menos días de envío.
